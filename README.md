# Project_inj
# Лабораторное занятие №10–12  
### Анализ продаж Walmart с использованием PySpark + расширенная документация и динамический датакаталог

---

## 1. Краткое резюме проекта

**Цель проекта:**  
Изучить основы работы с PySpark и реализовать базовый ETL-конвейер для анализа продаж Walmart. Дополнительно — создать профессионально оформленную проектную документацию и реализовать динамический датакаталог для автоматического описания используемых данных.

**Задачи проекта:**
- загрузка исходных данных Walmart;
- первичная очистка и приведение типов;
- фильтрация и выделение значимых записей;
- расчёт основных статистических показателей;
- сохранение результатов в каталог `/output`;
- генерация динамического датакаталога с метаданными.

---

## 2. Архитектура данных и ETL-процесса

### Общая схема проекта
/data (сырьевые данные: Walmart_Sales.csv)
↓ Extract
/scripts (PySpark обработка)
↓ Transform
/output (результаты фильтрации и аналитики)
↓ Load
data_catalog.csv (динамический каталог данных)

### Этапы ETL

**Extract**  
- Загрузка `Walmart_Sales.csv`  
- Автоматическое определение типов PySpark  

**Transform**  
- Приведение `Weekly_Sales` к double  
- Фильтрация строк с продажами > 100  
- Сортировка по убыванию  
- Расчёт статистики  

**Load**  
- Сохранение результатов в `/output/high_amount_sales`  
- Формирование динамического каталога `data_catalog.csv`  

---

## 3. Используемые технологии
- **Python 3.11**
- **Apache Spark (PySpark)**
- **pandas**
- **os / pathlib** — работа с файлами
- **CSV** — формат входных данных

---

## 4. Структура каталогов проекта

```
Project_inj/
│
├── data/                           # Исходные данные
│   └── Walmart_Sales.csv          # Основной датасет продаж
│
├── output/                         # Результаты обработки
│   └── high_amount_sales/         # Отфильтрованные данные
│       ├── part-00000-*.csv       # Файлы результатов
│       └── _SUCCESS               # Файл успешного выполнения
│
├── scripts/                        # Исполняемые скрипты
│   ├── analyse_walmart.py         # Основной ETL-скрипт
│   └── generate_data_catalog.py   # Генератор датакаталога
│
├── data_catalog.csv               # Автоматически обновляемый каталог данных
└── README.md                      # Документация проекта
```

---

## 5. Инструкция по запуску

### Установка зависимостей
```bash
pip install -r requirements.txt
python scripts/generate_data_catalog.py
```
## 6. Data Description
Walmart_Sales.csv - исходные данные о продажах

    Store - идентификатор магазина (Integer)

    Date - дата продаж (Date)

    Weekly_Sales - объём продаж за неделю (Double)

    Holiday_Flag - флаг праздничной недели (Integer)

    Temperature - температура в регионе (Double)

    Fuel_Price - цена топлива (Double)

    CPI - индекс потребительских цен (Double)

    Unemployment - уровень безработицы (Double)

high_amount_sales/ - отфильтрованные данные о крупных продажах

    Только продажи свыше 100 единиц

    Используется для анализа аномалий и выбросов


## 7. Участники проекта
Агабеков Арнур

## 8. Версия проекта

v1.2

Дата последнего обновления: 2025-11-17

## 9. датакаталог

/data_catalog.csv
